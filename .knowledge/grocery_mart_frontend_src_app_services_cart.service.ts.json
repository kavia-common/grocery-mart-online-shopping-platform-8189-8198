{"is_source_file": true, "format": "TypeScript", "description": "This file defines the CartService class providing cart management functionalities such as adding, removing, updating items, and calculating totals for an online shopping platform. It interacts with local storage via the safeStorage utility and uses RxJS BehaviorSubject for reactive data handling.", "external_files": ["../models/types", "../utils/platform"], "external_methods": ["safeStorage.getItem", "safeStorage.setItem"], "published": ["CartService"], "classes": [{"name": "CartService", "description": "An Angular service that manages shopping cart state, persists cart data, and provides observable reactions to cart changes."}], "methods": [{"name": "observe() { observe", "description": "Returns an observable stream of cart items that components can subscribe to for reactively updating the UI.", "scope": "CartService", "scopeKind": "class"}, {"name": "getItems(): CartItem[] { getItems", "description": "Returns a snapshot of the current cart items synchronously.", "scope": "CartService", "scopeKind": "class"}, {"name": "add(product: Product, qty = 1) { add", "description": "Adds a product to the cart with a specified quantity, or increases the quantity if it already exists.", "scope": "CartService", "scopeKind": "class"}, {"name": "remove(productId: string) { remove", "description": "Removes a product from the cart based on its product ID.", "scope": "CartService", "scopeKind": "class"}, {"name": "updateQuantity(productId: string, qty: number) { updateQuantity", "description": "Updates the quantity of a specific product in the cart; removes the item if the quantity is less than or equal to zero.", "scope": "CartService", "scopeKind": "class"}, {"name": "clear() { clear", "description": "Empties the shopping cart.", "scope": "CartService", "scopeKind": "class"}, {"name": "subtotal(): number { subtotal", "description": "Calculates and returns the total price of all items in the cart.", "scope": "CartService", "scopeKind": "class"}, {"name": "count(): number { count", "description": "Returns the total number of items in the cart.", "scope": "CartService", "scopeKind": "class"}, {"name": "private persist(items: CartItem[]) { persist", "scope": "CartService", "scopeKind": "class", "description": "unavailable"}, {"name": "private items$ = new BehaviorSubject<CartItem[]>(this.loadCart()); this", "scope": "CartService", "scopeKind": "class", "description": "unavailable"}], "calls": ["safeStorage.getItem", "JSON.parse", "safeStorage.setItem", "JSON.stringify"], "search-terms": ["Angular CartService", "cart management", "observable cart items", "persistent shopping cart", "rxjs BehaviorSubject", "add product to cart", "remove product", "update quantity", "calculate subtotal"], "state": 2, "file_id": 25, "knowledge_revision": 111, "git_revision": "", "revision_history": [{"52": ""}, {"111": ""}], "ctags": [{"_type": "tag", "name": "CART_KEY", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^const CART_KEY = 'gm_cart_v1';$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "CartService", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^export class CartService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "add", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  add(product: Product, qty = 1) {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "clear", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  clear() {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "count", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  count(): number {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "getItems", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  getItems(): CartItem[] {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^    const idx = items.findIndex(i => i.product.id === product.id);$/", "language": "TypeScript", "kind": "constant", "scope": "CartService.add", "scopeKind": "method"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^    const items = this.getItems()$/", "language": "TypeScript", "kind": "constant", "scope": "CartService.updateQuantity", "scopeKind": "method"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^    const items = this.getItems().filter(i => i.product.id !== productId);$/", "language": "TypeScript", "kind": "constant", "scope": "CartService.remove", "scopeKind": "method"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^    const items = this.getItems();$/", "language": "TypeScript", "kind": "constant", "scope": "CartService.add", "scopeKind": "method"}, {"_type": "tag", "name": "items$", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  private items$ = new BehaviorSubject<CartItem[]>(this.loadCart());$/", "language": "TypeScript", "kind": "property", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "observe", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  observe() {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "persist", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  private persist(items: CartItem[]) {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^      const raw = safeStorage.getItem(CART_KEY);$/", "language": "TypeScript", "kind": "constant", "scope": "CartService.this", "scopeKind": "method"}, {"_type": "tag", "name": "remove", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  remove(productId: string) {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "subtotal", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  subtotal(): number {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "this", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  private items$ = new BehaviorSubject<CartItem[]>(this.loadCart());$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}, {"_type": "tag", "name": "updateQuantity", "path": "/home/kavia/workspace/code-generation/grocery-mart-online-shopping-platform-8189-8198/grocery_mart_frontend/src/app/services/cart.service.ts", "pattern": "/^  updateQuantity(productId: string, qty: number) {$/", "language": "TypeScript", "kind": "method", "scope": "CartService", "scopeKind": "class"}], "hash": "dacd7f17065ed81bc5f04febba23c9a2", "format-version": 4, "code-base-name": "grocery_mart_frontend", "filename": "grocery_mart_frontend/src/app/services/cart.service.ts", "fields": [{"name": "private items$ = new BehaviorSubject<CartItem[]>(this.loadCart());", "scope": "CartService", "scopeKind": "class", "description": "unavailable"}]}